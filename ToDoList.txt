# linux-maint / linux_Maint_Scripts — ToDoList (living backlog)
#
# Rules:
# - Pick ONE item per session.
# - Prefer safe, minimal changes; assume current behavior is correct.
# - No new dependencies / no large refactors.
# - For any behavior change, add/extend tests and update summarize.txt.
#
# Priority legend:
# - P0: correctness/contract break or data loss risk
# - P1: high-value reliability improvements
# - P2: monitoring quality improvements
# - P3: DX/release polish

## P0 — Contract / correctness

### P0.1 Make summary_contract.sh robust to unprivileged baseline monitors (NOT DONE)
**Why**: `tests/summary_contract.sh` currently fails in unprivileged mode on `ports_baseline_monitor.sh` due to baseline dir permission errors, even though `tests/monitor_summary_emission_test.sh` already sets `LM_CFG_DIR` to avoid this.

**Where**:
- `tests/summary_contract.sh`

**Acceptance**:
- The contract test should run monitors with a writable `LM_CFG_DIR` (like `monitor_summary_emission_test.sh`) so baseline-based monitors can emit `monitor=` lines even when `/etc/linux_maint` is not writable.
- No behavior change to production code.

**Verify**:
- Running `bash tests/summary_contract.sh` succeeds as non-root.

---

## P1 — GitHub hygiene / readability (docs + repo layout)

### P1.0 Make README GitHub-friendly + add docs index (NOT DONE)
**Why**: README is the landing page. It should quickly answer: what is this, how do I run it, and where are the docs.

**Where**:
- `README.md`
- `docs/INDEX.md`

**Acceptance**:
- README has a prominent **Docs / references** block linking to:
  - `docs/INDEX.md`
  - `docs/QUICK_REFERENCE.md`
  - `docs/reference.md`
  - `docs/DARK_SITE.md`
  - `docs/REASONS.md`
- `docs/INDEX.md` exists and lists all major docs with 1-line descriptions.
- All links are relative and work on GitHub.

**Verify**:
- Click all doc links from README in GitHub UI.


## P2 — Monitoring quality (optional, safe)

### P2.1 Disk trend monitor: surface inode metrics in summary (optional) (NOT DONE)
**Why**: we now collect inode state (optional), but summary still only reports space trend counters.

**Where**:
- `monitors/disk_trend_monitor.sh`

**Acceptance**:
- When `LM_DISK_TREND_INODES=1`, include a small, parse-safe inode rollup in summary, e.g. `inode_mounts=<n>` and `inode_max_used_pct=<n>` (or similar).
- Keep summary line short; avoid listing per-mount details.

**Verify**:
- Extend `tests/disk_trend_inode_trend_test.sh` to assert the new inode summary keys.

---

## P3 — DX / release polish

### P3.1 Make target for hooks install: `make install-githooks` (NOT DONE)
**Why**: now that `tools/install_githooks.sh` exists, a make alias is a small QoL for contributors.

**Where**:
- `Makefile`

**Acceptance**:
- `make install-githooks` runs `./tools/install_githooks.sh`.
- Mentioned in `make help`.

**Verify**:
- Running twice is safe.

### P1.1 Status filtering: support regex / exact-match mode (NOT DONE)
**Why**: current `--host` and `--monitor` use substring matching only; operators may want exact or regex matching for stricter automation.

**Where**:
- `bin/linux-maint`
- `docs/reference.md`
- `tests/status_filters_test.sh`

**Acceptance**:
- Add optional status flags for explicit match modes (for example `--host-regex`, `--monitor-regex`, or `--exact`).
- Keep existing substring behavior fully backward-compatible.
- JSON and compact outputs must apply the same matching semantics.

**Verify**:
- Extend `tests/status_filters_test.sh` with positive + negative cases for the new mode(s).

### P1.2 Dark-site profile switch (NOT DONE)
**Why**: operators in air-gapped environments often want a single simple toggle to keep network-facing checks conservative.

**Where**:
- `etc/linux_maint/linux-maint.conf.example`
- `run_full_health_monitor.sh`
- `docs/DARK_SITE.md`

**Acceptance**:
- Add an optional dark-site profile flag (for example `LM_DARK_SITE=true`) that keeps defaults simple/safe for offline environments.
- Ensure behavior remains backward-compatible when flag is unset.
- Document exactly what the profile changes.

**Verify**:
- Add tests that confirm profile-on behavior and unchanged defaults when profile is off.
=======

