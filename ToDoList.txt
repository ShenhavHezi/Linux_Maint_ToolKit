# linux-maint — ToDoList (roadmap refresh)

This is the single backlog source of truth.

## Working style
- Prefer small, test-backed changes.
- Avoid breaking contracts without explicit versioning.
- Optimize for safe defaults and clear operator guidance.
- Keep dark-site/offline reliability a top priority.

## Priorities
- **P0**: correctness, reliability, determinism
- **P1**: operator UX and documentation
- **P2**: security and hardening
- **P3**: observability and integrations
- **P4**: DX/release polish

---

## P0 — Correctness / reliability

### P0.1 Validate summary lines at source (lm_summary guardrails) (DONE 2026-02-18)
**Why**: contract violations should be caught at emission time, not later.
**Scope**:
- Add an optional strict mode (`LM_SUMMARY_STRICT=1`) that validates required keys and allowed statuses.
- In strict mode, log an error and exit non-zero when violations occur.
**Acceptance**:
- Unit-style tests covering strict and non-strict behavior.

### P0.2 Tighten wrapper failure modes and recovery (DONE 2026-02-18)
**Why**: wrapper should never produce partial artifacts without clear warnings.
**Scope**:
- Emit explicit wrapper-level WARN lines when summary/log writes fail.
- Ensure JSON output indicates missing artifacts clearly.
**Acceptance**:
- New tests simulate unwritable log/summary directories and validate fallback messaging.

### P0.3 Add deterministic test seed for time-based outputs (DONE 2026-02-18)
**Why**: log timestamps and runtime summaries can cause nondeterministic tests.
**Scope**:
- Support `LM_TEST_TIME_EPOCH` for wrapper/test mode to freeze timestamps.
**Acceptance**:
- At least one test demonstrates stable output under frozen time.

---

## P1 — Operator UX / documentation

### P1.1 Add a troubleshooting decision tree
**Why**: on-call needs a predictable path from WARN/CRIT to actions.
**Scope**:
- Add a short decision tree in `docs/QUICK_REFERENCE.md`.
**Acceptance**:
- Includes steps for `status`, `logs`, `doctor`, `diff`, `pack-logs`.

### P1.2 Add per-monitor “What to check next” snippets
**Why**: makes `reason=` tokens actionable.
**Scope**:
- Add a section in `docs/reference.md` per monitor with next checks.
**Acceptance**:
- At least 5 monitors covered with concrete guidance.

---

## P2 — Security / hardening

### P2.1 Add optional allowlist for summary keys
**Why**: prevent untrusted data from being emitted into summary lines.
**Scope**:
- `LM_SUMMARY_ALLOWLIST` to restrict which keys can appear in `monitor=` lines.
**Acceptance**:
- Default allows all; when set, extra keys are dropped with a warning.

### P2.2 Add log bundle redaction in pack-logs
**Why**: bundles are shared externally.
**Scope**:
- Apply redaction to packed logs if `LM_REDACT_LOGS=1`.
**Acceptance**:
- New test verifies redaction in packed bundle.

---

## P3 — Observability / integrations

### P3.1 Add JSON schema for export payload
**Why**: `export --json` is now a stable integration surface.
**Scope**:
- Add `docs/schemas/export.json` and validation test.
**Acceptance**:
- Schema test passes in repo mode.

### P3.2 Add optional CSV export for summary rows
**Why**: quick import into spreadsheets/BI tools.
**Scope**:
- `linux-maint export --csv` writes rows with stable columns.
**Acceptance**:
- CSV output includes header and at least `monitor,host,status,reason`.

---

## P4 — DX / release polish

### P4.1 Add a minimal CI smoke profile doc
**Why**: contributors need to know which tests are run where.
**Scope**:
- Document `SMOKE_PROFILE=compat/full` and expected behavior.
**Acceptance**:
- Added to `CONTRIBUTING.md`.

### P4.2 Add a release checklist
**Why**: reduce release mistakes.
**Scope**:
- Add `docs/RELEASE_CHECKLIST.md`.
**Acceptance**:
- Checklist includes version bump, changelog, tarball, checksum, and validation steps.
